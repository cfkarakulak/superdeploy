# App Services for cheapa
# Auto-generated by: superdeploy generate

networks:
  cheapa-network:
    name: cheapa-network
    external: true

services:

  api:
    image: ${DOCKER_REGISTRY:-docker.io}/${DOCKER_ORG}/api:${API_TAG}
    container_name: cheapa-api
    restart: unless-stopped
    ports:
      - "8000:8000"
    env_file:
      - .env.api
    networks:
      - cheapa-network
    # RESOURCE LIMITS: Prevent OOM and ensure fair resource sharing
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '1.0'
        reservations:
          memory: 256M
          cpus: '0.5'

  storefront:
    image: ${DOCKER_REGISTRY:-docker.io}/${DOCKER_ORG}/storefront:${STOREFRONT_TAG}
    container_name: cheapa-storefront
    restart: unless-stopped
    ports:
      - "3000:3000"
    env_file:
      - .env.storefront
    networks:
      - cheapa-network
    # RESOURCE LIMITS: Prevent OOM and ensure fair resource sharing
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '1.0'
        reservations:
          memory: 256M
          cpus: '0.5'

  services:
    image: ${DOCKER_REGISTRY:-docker.io}/${DOCKER_ORG}/services:${SERVICES_TAG}
    container_name: cheapa-services
    restart: unless-stopped
    ports:
      - "8001:8001"
    env_file:
      - .env.services
    networks:
      - cheapa-network
    # RESOURCE LIMITS: Prevent OOM and ensure fair resource sharing
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '1.0'
        reservations:
          memory: 256M
          cpus: '0.5'