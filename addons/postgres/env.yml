# Environment variables for .env.superdeploy
variables:
  POSTGRES_VERSION:
    source: config
    from_project: "addons.postgres.version"
    default: "15-alpine"
    required: false
    description: "PostgreSQL Docker image version"
    
  POSTGRES_HOST:
    source: runtime
    from_ansible: "ansible_default_ipv4.address"
    default: "localhost"
    required: true
    description: "PostgreSQL hostname (resolved at runtime)"
    
  POSTGRES_PORT:
    source: config
    from_project: "addons.postgres.port"
    default: "5432"
    required: false
    description: "PostgreSQL port"
    
  POSTGRES_USER:
    source: config
    from_project: "addons.postgres.user"
    default: "${PROJECT}_user"
    required: true
    description: "Database username"
    
  POSTGRES_PASSWORD:
    source: secret
    from_secrets: "POSTGRES_PASSWORD"
    required: true
    generate: true
    description: "Database password (auto-generated)"
    
  POSTGRES_DB:
    source: config
    from_project: "addons.postgres.database"
    default: "${PROJECT}_db"
    required: true
    description: "Database name"
  
  # ============================================================================
  # Database Abstraction Layer (DB_*)
  # ============================================================================
  # Generic database interface that works with any database addon (PostgreSQL, MySQL, etc.)
  # Applications use DB_* variables to be database-agnostic
  # Switching databases only requires changing project.yml, not application code
  
  DB_CONNECTION:
    source: config
    default: "app"
    required: false
    description: "Database connection name (abstraction layer)"
    
  DB_HOST:
    source: runtime
    from_ansible: "ansible_default_ipv4.address"
    default: "localhost"
    required: true
    description: "Database host (maps to POSTGRES_HOST)"
    
  DB_PORT:
    source: config
    from_project: "addons.postgres.port"
    default: "5432"
    required: false
    description: "Database port (maps to POSTGRES_PORT)"
    
  DB_USERNAME:
    source: config
    from_project: "addons.postgres.user"
    default: "${PROJECT}_user"
    required: true
    description: "Database username (maps to POSTGRES_USER)"
    
  DB_PASSWORD:
    source: secret
    value: "${POSTGRES_PASSWORD}"
    required: true
    description: "Database password (maps to POSTGRES_PASSWORD)"
    
  DB_DATABASE:
    source: config
    from_project: "addons.postgres.database"
    default: "${PROJECT}_db"
    required: true
    description: "Database name (maps to POSTGRES_DB)"

# GitHub Actions secrets mapping
github_secrets:
  # PostgreSQL-specific namespace
  - POSTGRES_HOST
  - POSTGRES_PORT
  - POSTGRES_USER
  - POSTGRES_PASSWORD
  - POSTGRES_DB
  # Database abstraction layer (database-agnostic interface)
  - DB_HOST
  - DB_PORT
  - DB_USERNAME
  - DB_PASSWORD
  - DB_DATABASE

# Forgejo Actions secrets mapping (same as GitHub)
forgejo_secrets:
  # PostgreSQL-specific namespace
  - POSTGRES_HOST
  - POSTGRES_PORT
  - POSTGRES_USER
  - POSTGRES_PASSWORD
  - POSTGRES_DB
  # Database abstraction layer (database-agnostic interface)
  - DB_HOST
  - DB_PORT
  - DB_USERNAME
  - DB_PASSWORD
  - DB_DATABASE
