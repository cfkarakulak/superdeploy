# MongoDB Addon Metadata
name: mongodb
description: MongoDB NoSQL document database
version: "7.0"
category: database

# Resource plans (small/standard/large/xlarge)
plans:
  small:
    memory: 256M
    cpu: 0.25
    disk: 5G
    description: "For development/testing"
    
  standard:
    memory: 512M
    cpu: 0.5
    disk: 10G
    description: "For production workloads"
    
  large:
    memory: 1G
    cpu: 1.0
    disk: 20G
    description: "For high-traffic databases"
    
  xlarge:
    memory: 2G
    cpu: 2.0
    disk: 50G
    description: "For enterprise databases"

# Environment variable template (uses {INSTANCE} placeholder)
env_template:
  - name: "{INSTANCE}_URL"
    description: "Full MongoDB connection URL"
    format: "mongodb://{USER}:{PASSWORD}@{HOST}:{PORT}/{DATABASE}"
    
  - name: "{INSTANCE}_HOST"
    description: "MongoDB hostname"
    
  - name: "{INSTANCE}_PORT"
    description: "MongoDB port"
    
  - name: "{INSTANCE}_USER"
    description: "Database username"
    
  - name: "{INSTANCE}_PASSWORD"
    description: "Database password"
    secret: true
    
  - name: "{INSTANCE}_DATABASE"
    description: "Database name"
    
  - name: "{INSTANCE}_ROOT_PASSWORD"
    description: "Root password for MongoDB admin"
    secret: true

# Port allocation strategy
port_allocation:
  base_port: 27017
  increment: 1  # Second instance: 27018, Third: 27019

# Docker compose configuration
compose:
  volumes:
    - mongodb-data
  ports: []
  networks:
    - project-network
  expose:
    - "27017"

# Resource requirements
resources:
  memory: 512M
  cpu: 0.5
  disk: 10G

# Health check
healthcheck:
  command: "mongosh --eval 'db.runCommand({ ping: 1 })' --quiet"
  interval: 10s
  timeout: 5s
  retries: 5
  start_period: 30s

# Dependencies (other addons required)
requires: []

# Conflicts (cannot coexist with)
conflicts: []

# Tags for monitoring
monitoring:
  enabled: true
  metrics_port: 9216
  dashboard: mongodb-overview.json
