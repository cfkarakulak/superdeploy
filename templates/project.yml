# =============================================================================
# {{PROJECT}} - Project Configuration
# =============================================================================
# Auto-generated by: superdeploy init -p {{PROJECT}}
# Edit this file, then run: superdeploy generate -p {{PROJECT}}
# =============================================================================

# Project Information
project:
  name: {{PROJECT}}
  description: {{PROJECT}} project
  created_at: {{CREATED_AT}}
  ssl_email: ""  # For Let's Encrypt certificates (e.g., admin@{{PROJECT}}.com)

# =============================================================================
# Cloud Provider Configuration
# =============================================================================
cloud:
  # GCP Configuration
  gcp:
    project_id: "your-gcp-project-id"  # EDIT THIS
    region: "us-central1"
    zone: "us-central1-a"
  
  # SSH Configuration (for VM access)
  ssh:
    key_path: "~/.ssh/superdeploy_deploy"
    public_key_path: "~/.ssh/superdeploy_deploy.pub"
    user: "superdeploy"

# =============================================================================

# Infrastructure Configuration
# =============================================================================
# Core infrastructure services (always deployed)
# Forgejo is the Git server with CI/CD capabilities
infrastructure:
  # VM Configuration (applies to all VMs unless overridden)
  vm_config:
    # Machine type (GCP instance type)
    # Examples: e2-micro, e2-small, e2-medium, e2-standard-2, n1-standard-1
    machine_type: e2-medium
    
    # Disk size in GB
    disk_size: 20
    
    # VM boot disk image
    # Examples: debian-cloud/debian-11, ubuntu-os-cloud/ubuntu-2204-lts
    image: debian-cloud/debian-11
  
  forgejo:
    # Forgejo version (Docker image tag)
    version: "13"
    
    # Web interface port (default: 3001)
    port: 3001
    
    # SSH port for Git operations (default: 2222)
    ssh_port: 2222
    
    # Admin user configuration
    admin_user: "admin"
    admin_email: "admin@{{PROJECT}}.local"
    
    # Organization and repository names
    # The organization will be created automatically
    org: "{{PROJECT}}"
    
    # Repository name for the project (default: superdeploy)
    repo: "superdeploy"
    
    # Database configuration (PostgreSQL)
    db_name: "forgejo"
    db_user: "forgejo"
    # Note: db_password is auto-generated and stored in secrets.yml

# =============================================================================
# VMs (Infrastructure)
# =============================================================================
vms:
  core:
    count: 1
    machine_type: e2-medium
    disk_size: 20
    # Services that run on this VM (Caddy is automatically added to all VMs)
    services:
      - postgres
      - rabbitmq
  
  # Add more VMs as needed:
  # worker:
  #   count: 2
  #   machine_type: e2-small
  #   disk_size: 20
  #   services: []

# =============================================================================
# Core Services (Addon-Based Infrastructure)
# =============================================================================
# Available addons: postgres, redis, rabbitmq, mongodb, caddy, monitoring
# Each addon can have version overrides and custom configuration
addons:
  postgres:
    # Optional: Override default version from addon.yml
    # version: "15-alpine"
    # Optional: Custom configuration (merged with addon defaults)
    # user: "{{PROJECT}}_user"
    # database: "{{PROJECT}}_db"
  
  rabbitmq:
    # Optional: Override default version from addon.yml
    # version: "3.12-management-alpine"
    # Optional: Custom configuration
    # user: "{{PROJECT}}_user"
  
  # Uncomment to add more addons:
  # redis:
  #   # Optional: Override default version
  #   # version: "7-alpine"
  # 
  # mongodb:
  #   # Optional: Override default version
  #   # version: "7-alpine"
  #   # Optional: Custom configuration
  #   # user: "{{PROJECT}}_user"
  #   # database: "{{PROJECT}}_db"
  #
  # caddy:
  #   # Optional: Override default version
  #   # version: "2-alpine"
  #   # Optional: Custom domain configuration
  #   # domain: "{{PROJECT}}.example.com"
  #   # email: "admin@example.com"

# =============================================================================
# Application Services
# =============================================================================
apps:
  api:
    path: /absolute/path/to/app-repos/api  # EDIT THIS
    vm: core  # Which VM to deploy on
    port: 8000
  
  dashboard:
    path: /absolute/path/to/app-repos/dashboard  # EDIT THIS
    vm: core
    port: 3000  # Dashboard runs on port 3000 internally
  
  # Add more apps:
  # services:
  #   path: /absolute/path/to/app-repos/services
  #   vm: core
  #   port: 8001  # Services (proxy registry) on port 8001

# =============================================================================
# GitHub Configuration
# =============================================================================
github:
  organization: {{PROJECT}}io  # EDIT THIS
  # Variables: GITHUB_TOKEN (from .env)

# =============================================================================
# Network Configuration
# =============================================================================
network:
  subnet: {{SUBNET}}
#   dashboard:
#     domain: "dashboard.{{PROJECT}}.com"
# DNS A records must point to the VM's IP where the app runs
