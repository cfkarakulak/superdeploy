# =============================================================================
# {{PROJECT}} - Project Configuration
# =============================================================================
# Auto-generated by: superdeploy init -p {{PROJECT}}
# Edit this file, then run: superdeploy generate -p {{PROJECT}}
# =============================================================================

project: {{PROJECT}}
description: {{PROJECT}} project
created_at: {{CREATED_AT}}

# =============================================================================
# Infrastructure Configuration
# =============================================================================
# Core infrastructure services (always deployed)
# Forgejo is the Git server with CI/CD capabilities
infrastructure:
  forgejo:
    # Forgejo version (Docker image tag)
    version: "13"
    
    # Web interface port (default: 3001)
    port: 3001
    
    # SSH port for Git operations (default: 2222)
    ssh_port: 2222
    
    # Admin user configuration
    admin_user: "admin"
    admin_email: "admin@{{PROJECT}}.local"
    
    # Organization and repository names
    # The organization will be created automatically
    org: "{{PROJECT}}io"
    
    # Repository name for the project (default: superdeploy)
    repo: "superdeploy"
    
    # Database configuration (PostgreSQL)
    db_name: "forgejo"
    db_user: "forgejo"
    # Note: db_password is auto-generated and stored in .passwords.yml

# =============================================================================
# VMs (Infrastructure)
# =============================================================================
vms:
  core:
    count: 1
    machine_type: e2-medium
    disk_size: 20
    # Services that run on this VM
    services:
      - postgres
      - rabbitmq
      - forgejo
  
  # Add more VMs as needed:
  # worker:
  #   count: 2
  #   machine_type: e2-small
  #   disk_size: 20
  #   services: []

# =============================================================================
# Core Services (Addon-Based Infrastructure)
# =============================================================================
# Available addons: postgres, redis, rabbitmq, mongodb, caddy, monitoring
# Each addon can have version overrides and custom configuration
core_services:
  postgres:
    # Optional: Override default version from addon.yml
    # version: "15-alpine"
    # Optional: Custom configuration (merged with addon defaults)
    # user: "{{PROJECT}}_user"
    # database: "{{PROJECT}}_db"
  
  rabbitmq:
    # Optional: Override default version from addon.yml
    # version: "3.12-management-alpine"
    # Optional: Custom configuration
    # user: "{{PROJECT}}_user"
  
  # Uncomment to add more addons:
  # redis:
  #   # Optional: Override default version
  #   # version: "7-alpine"
  # 
  # mongodb:
  #   # Optional: Override default version
  #   # version: "7-alpine"
  #   # Optional: Custom configuration
  #   # user: "{{PROJECT}}_user"
  #   # database: "{{PROJECT}}_db"
  #
  # caddy:
  #   # Optional: Override default version
  #   # version: "2-alpine"
  #   # Optional: Custom domain configuration
  #   # domain: "{{PROJECT}}.example.com"
  #   # email: "admin@example.com"

# =============================================================================
# Application Services
# =============================================================================
apps:
  api:
    path: /absolute/path/to/app-repos/api  # EDIT THIS
    vm: core  # Which VM to deploy on
    port: 8000
  
  dashboard:
    path: /absolute/path/to/app-repos/dashboard  # EDIT THIS
    vm: core
    port: 8010
  
  # Add more apps:
  # services:
  #   path: /absolute/path/to/app-repos/services
  #   vm: core
  #   port: 8020

# =============================================================================
# GitHub Configuration
# =============================================================================
github:
  organization: {{PROJECT}}io  # EDIT THIS

# =============================================================================
# Network Configuration
# =============================================================================
network:
  subnet: {{SUBNET}}

# =============================================================================
# Monitoring (Optional)
# =============================================================================
monitoring:
  enabled: true
  prometheus: true
  grafana: true

# =============================================================================
# Domain (Optional)
# =============================================================================
domain: ""  # e.g., myproject.com
