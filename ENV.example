# =============================================================================
# SuperDeploy Complete Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# This single file controls EVERYTHING - no more hardcoded values!
#
# IMPORTANT: 
#   - Never commit .env to git!
#   - Update IPs when VMs restart
#   - All services read from this file

# -----------------------------------------------------------------------------
# VM Network Configuration (UPDATE THESE IF VMS RESTART!)
# -----------------------------------------------------------------------------
CORE_EXTERNAL_IP=34.56.43.99
CORE_INTERNAL_IP=10.0.0.5
SCRAPE_EXTERNAL_IP=34.67.236.167
SCRAPE_INTERNAL_IP=10.0.0.7
PROXY_EXTERNAL_IP=34.173.11.246
PROXY_INTERNAL_IP=10.0.0.6

# -----------------------------------------------------------------------------
# Forgejo Git Server Configuration
# -----------------------------------------------------------------------------
FORGEJO_URL=http://${CORE_EXTERNAL_IP}:3001
FORGEJO_REPO_OWNER=cradexco
FORGEJO_REPO_NAME=superdeploy-app
# Create token at: http://${CORE_EXTERNAL_IP}:3001/user/settings/applications
FORGEJO_TOKEN=

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_DB=superdeploy
POSTGRES_USER=superdeploy
POSTGRES_PASSWORD=
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# -----------------------------------------------------------------------------
# Message Queue Configuration (RabbitMQ)
# -----------------------------------------------------------------------------
RABBITMQ_DEFAULT_USER=superdeploy
RABBITMQ_DEFAULT_PASS=
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_VHOST=/
RABBITMQ_QUEUE_NAME=scraping_jobs

# -----------------------------------------------------------------------------
# API Service Configuration
# -----------------------------------------------------------------------------
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=2
API_LOG_LEVEL=info
API_DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}
API_RABBITMQ_URL=amqp://${RABBITMQ_DEFAULT_USER}:${RABBITMQ_DEFAULT_PASS}@${RABBITMQ_HOST}:${RABBITMQ_PORT}${RABBITMQ_VHOST}
API_SECRET_KEY=

# -----------------------------------------------------------------------------
# Proxy Registry Service Configuration
# -----------------------------------------------------------------------------
PROXY_REGISTRY_HOST=0.0.0.0
PROXY_REGISTRY_PORT=8080
PROXY_REGISTRY_DB_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}
PROXY_REGISTRY_USER=admin
PROXY_REGISTRY_PASS=
PROXY_REGISTRY_API_KEY=

# -----------------------------------------------------------------------------
# Proxy Server Configuration
# -----------------------------------------------------------------------------
PROXY_USER=proxyuser
PROXY_PASSWORD=
SOCKS5_PORT=1080
HTTP_PROXY_PORT=3128
IP_CHECK_INTERVAL=300
IP_CHECK_URL=https://api.ipify.org
IP_UPDATE_ENDPOINT=http://${CORE_INTERNAL_IP}:${PROXY_REGISTRY_PORT}/api/proxies/update
PROXY_ALLOWED_IPS=
PROXY_TIMEOUT=30
PROXY_RETRY_COUNT=3
PROXY_ROTATION_INTERVAL=300

# -----------------------------------------------------------------------------
# Worker Configuration
# -----------------------------------------------------------------------------
WORKER_CONCURRENCY=2
WORKER_LOG_LEVEL=info
WORKER_NAME=scrape-worker
PLAYWRIGHT_TIMEOUT=30000
PLAYWRIGHT_HEADLESS=true

# -----------------------------------------------------------------------------
# Scraping Configuration
# -----------------------------------------------------------------------------
USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
MAX_RETRIES=3
DOWNLOAD_DELAY=1
CONCURRENT_REQUESTS=5

# -----------------------------------------------------------------------------
# Monitoring & Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=json
ENABLE_METRICS=true
SENTRY_DSN=

# -----------------------------------------------------------------------------
# Web Server Configuration (Caddy)
# -----------------------------------------------------------------------------
DOMAIN=${CORE_EXTERNAL_IP}
ACME_EMAIL=admin@superdeploy.io

# -----------------------------------------------------------------------------
# Environment
# -----------------------------------------------------------------------------
ENVIRONMENT=production
DEBUG=false

# -----------------------------------------------------------------------------
# Security & JWT
# -----------------------------------------------------------------------------
SECRET_KEY=
JWT_SECRET=

# -----------------------------------------------------------------------------
# SSH Configuration (for Ansible)
# -----------------------------------------------------------------------------
ANSIBLE_SSH_KEY=~/.ssh/cfk_gcp
ANSIBLE_SSH_USER=superdeploy

# -----------------------------------------------------------------------------
# Service URLs (Auto-generated from above)
# -----------------------------------------------------------------------------
# Core Services
CORE_API_URL=http://${CORE_INTERNAL_IP}:${API_PORT}
CORE_DB_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${CORE_INTERNAL_IP}:${POSTGRES_PORT}/${POSTGRES_DB}
CORE_RABBITMQ_URL=amqp://${RABBITMQ_DEFAULT_USER}:${RABBITMQ_DEFAULT_PASS}@${CORE_INTERNAL_IP}:${RABBITMQ_PORT}${RABBITMQ_VHOST}

# Proxy Registry
PROXY_REGISTRY_URL=http://${CORE_INTERNAL_IP}:${PROXY_REGISTRY_PORT}

