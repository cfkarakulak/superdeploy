---
# System security role default variables

# Security packages to install
security_packages:
  - ufw
  - fail2ban
  - unattended-upgrades
  - apt-listchanges

# Firewall configuration
firewall_additional_ports: []
# Example:
# firewall_additional_ports:
#   - 8000  # API
#   - 3001  # Forgejo
#   - 5432  # PostgreSQL

# Fail2Ban configuration
fail2ban_maxretry: 3
fail2ban_bantime: 3600
fail2ban_findtime: 600

# SSH hardening
ssh_hardening_enabled: true

# Sysctl hardening parameters
sysctl_hardening_params:
  - { name: 'vm.max_map_count', value: '262144' }  # For Elasticsearch if needed
  - { name: 'net.ipv4.tcp_syncookies', value: '1' }
  - { name: 'net.ipv4.ip_forward', value: '0' }
  - { name: 'net.ipv4.conf.all.accept_redirects', value: '0' }
  - { name: 'net.ipv4.conf.all.send_redirects', value: '0' }
  - { name: 'net.ipv4.conf.all.accept_source_route', value: '0' }
  - { name: 'kernel.dmesg_restrict', value: '1' }
